# Equity Research Dashboard Backend - Environment Configuration
# Updated for IEX Cloud Migration (August 2024)

# =============================================================================
# APPLICATION CONFIGURATION
# =============================================================================
ENVIRONMENT=development
DEBUG=true
LOG_LEVEL=INFO

# =============================================================================
# DATABASE CONFIGURATION
# =============================================================================
# PostgreSQL connection URL with asyncpg driver
DATABASE_URL=postgresql+asyncpg://postgres:password@localhost:5432/equity_research
DATABASE_ECHO=false
DATABASE_POOL_SIZE=10
DATABASE_MAX_OVERFLOW=20
DATABASE_POOL_TIMEOUT=30
DATABASE_POOL_RECYCLE=3600

# =============================================================================
# REDIS CONFIGURATION
# =============================================================================
# Redis connection URL for caching and sessions
REDIS_URL=redis://localhost:6379/0
REDIS_MAX_CONNECTIONS=20
REDIS_SOCKET_TIMEOUT=5
REDIS_SOCKET_CONNECT_TIMEOUT=5
REDIS_RETRY_ON_TIMEOUT=true

# =============================================================================
# SECURITY CONFIGURATION
# =============================================================================
# JWT Secret Key - CHANGE THIS IN PRODUCTION!
SECRET_KEY=your-secret-key-change-in-production-minimum-32-characters
ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=15
REFRESH_TOKEN_EXPIRE_DAYS=7
PASSWORD_MIN_LENGTH=8
BCRYPT_ROUNDS=12

# =============================================================================
# CORS CONFIGURATION
# =============================================================================
# Allowed CORS origins (comma-separated)
CORS_ORIGINS=http://localhost:3000,http://localhost:5173
CORS_ALLOW_CREDENTIALS=true
CORS_ALLOW_METHODS=*
CORS_ALLOW_HEADERS=*

# =============================================================================
# RATE LIMITING
# =============================================================================
RATE_LIMIT_REQUESTS=1000
RATE_LIMIT_WINDOW=3600

# =============================================================================
# FINANCIAL DATA API KEYS
# =============================================================================
# Primary Provider: Financial Modeling Prep (FMP)
# Get your API key at: https://financialmodelingprep.com/developer/docs
# Free tier: 250 requests/day
# Basic: $14/month (10,000 requests/day)
# Professional: $29/month (50,000 requests/day)
FINANCIAL_MODELING_PREP_API_KEY=your_financial_modeling_prep_api_key

# Secondary Provider: Alpha Vantage
# Get your API key at: https://www.alphavantage.co/support/#api-key
# Free tier: 500 requests/day
# Premium: $49.99/month (1,200 requests/day)
ALPHA_VANTAGE_API_KEY=your_alpha_vantage_api_key

# Tertiary Provider: Tiingo
# Get your API key at: https://www.tiingo.com/
# Free tier: 1,000 requests/day
# Starter: $10/month (10,000 requests/day)
# Professional: $20/month (50,000 requests/day)
TIINGO_API_KEY=your_tiingo_api_key

# Free Alternative: Yahoo Finance (no API key required)
# Enable/disable Yahoo Finance as a fallback option
YAHOO_FINANCE_ENABLED=true

# =============================================================================
# MONITORING CONFIGURATION
# =============================================================================
# Sentry DSN for error tracking
SENTRY_DSN=your_sentry_dsn

# Prometheus metrics collection
PROMETHEUS_ENABLED=true

# =============================================================================
# FILE UPLOAD CONFIGURATION
# =============================================================================
# Maximum file upload size in bytes (10MB)
UPLOAD_MAX_SIZE=10485760

# Allowed file extensions for uploads
UPLOAD_ALLOWED_EXTENSIONS=.pdf,.xlsx,.csv,.json

# =============================================================================
# WEBSOCKET CONFIGURATION
# =============================================================================
# WebSocket heartbeat interval in seconds
WEBSOCKET_HEARTBEAT_INTERVAL=30

# Maximum number of concurrent WebSocket connections
WEBSOCKET_MAX_CONNECTIONS=1000

# =============================================================================
# EMAIL CONFIGURATION (Optional)
# =============================================================================
# SMTP settings for email notifications
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USERNAME=your_email@gmail.com
SMTP_PASSWORD=your_app_password
SMTP_USE_TLS=true

# =============================================================================
# EXTERNAL SERVICE CONFIGURATION
# =============================================================================
# News API for market news and sentiment
NEWS_API_KEY=your_news_api_key

# Economic data API (if needed)
ECONOMIC_DATA_API_KEY=your_economic_data_api_key

# =============================================================================
# DEVELOPMENT CONFIGURATION
# =============================================================================
# Enable/disable development features
ENABLE_DEBUG_TOOLBAR=false
ENABLE_SQL_LOGGING=false
ENABLE_API_DOCS=true

# Test database URL (for testing)
TEST_DATABASE_URL=postgresql+asyncpg://postgres:password@localhost:5432/equity_research_test

# =============================================================================
# PRODUCTION CONFIGURATION
# =============================================================================
# Production-specific settings
# SECURE_SSL_REDIRECT=true
# SESSION_COOKIE_SECURE=true
# CSRF_COOKIE_SECURE=true

# =============================================================================
# API RATE LIMITING PER PROVIDER
# =============================================================================
# Financial Modeling Prep rate limits
FMP_RATE_LIMIT_PER_MINUTE=60
FMP_RATE_LIMIT_PER_DAY=10000

# Alpha Vantage rate limits
ALPHA_VANTAGE_RATE_LIMIT_PER_MINUTE=5
ALPHA_VANTAGE_RATE_LIMIT_PER_DAY=500

# Tiingo rate limits
TIINGO_RATE_LIMIT_PER_MINUTE=100
TIINGO_RATE_LIMIT_PER_DAY=1000

# =============================================================================
# CACHING CONFIGURATION
# =============================================================================
# Cache TTL settings (in seconds)
CACHE_TTL_QUOTES=300          # 5 minutes
CACHE_TTL_HISTORICAL=3600     # 1 hour
CACHE_TTL_PROFILES=86400      # 24 hours
CACHE_TTL_NEWS=1800           # 30 minutes

# =============================================================================
# LOGGING CONFIGURATION
# =============================================================================
# Log file paths
LOG_FILE_PATH=logs/app.log
ERROR_LOG_FILE_PATH=logs/error.log
ACCESS_LOG_FILE_PATH=logs/access.log

# Log rotation settings
LOG_MAX_SIZE=10485760         # 10MB
LOG_BACKUP_COUNT=5
LOG_ROTATION_INTERVAL=1       # 1 day

# =============================================================================
# HEALTH CHECK CONFIGURATION
# =============================================================================
# Health check intervals (in seconds)
HEALTH_CHECK_INTERVAL=30
DATABASE_HEALTH_CHECK_INTERVAL=60
REDIS_HEALTH_CHECK_INTERVAL=60
EXTERNAL_API_HEALTH_CHECK_INTERVAL=300

# =============================================================================
# SECURITY HEADERS
# =============================================================================
# Security header configuration
SECURITY_HEADERS_ENABLED=true
CONTENT_SECURITY_POLICY=default-src 'self'
X_FRAME_OPTIONS=DENY
X_CONTENT_TYPE_OPTIONS=nosniff
X_XSS_PROTECTION=1; mode=block
STRICT_TRANSPORT_SECURITY=max-age=31536000; includeSubDomains

# =============================================================================
# FEATURE FLAGS
# =============================================================================
# Enable/disable specific features
ENABLE_PORTFOLIO_OPTIMIZATION=true
ENABLE_RISK_ANALYSIS=true
ENABLE_DCF_MODELING=true
ENABLE_COMPARABLE_ANALYSIS=true
ENABLE_REPORT_GENERATION=true
ENABLE_REAL_TIME_DATA=true
ENABLE_TECHNICAL_INDICATORS=true
ENABLE_NEWS_SENTIMENT=true

# =============================================================================
# NOTIFICATION CONFIGURATION
# =============================================================================
# Notification settings
ENABLE_EMAIL_NOTIFICATIONS=false
ENABLE_PUSH_NOTIFICATIONS=false
ENABLE_SMS_NOTIFICATIONS=false

# Notification templates
NOTIFICATION_TEMPLATE_PATH=templates/notifications/

# =============================================================================
# BACKUP CONFIGURATION
# =============================================================================
# Database backup settings
ENABLE_AUTOMATIC_BACKUPS=false
BACKUP_SCHEDULE=0 2 * * *        # Daily at 2 AM
BACKUP_RETENTION_DAYS=30
BACKUP_STORAGE_PATH=backups/

# =============================================================================
# PERFORMANCE CONFIGURATION
# =============================================================================
# Performance optimization settings
ENABLE_QUERY_OPTIMIZATION=true
ENABLE_CONNECTION_POOLING=true
ENABLE_RESPONSE_COMPRESSION=true
ENABLE_STATIC_FILE_CACHING=true

# Worker configuration
CELERY_BROKER_URL=redis://localhost:6379/1
CELERY_RESULT_BACKEND=redis://localhost:6379/2
CELERY_WORKER_CONCURRENCY=4

# =============================================================================
# INTEGRATION CONFIGURATION
# =============================================================================
# Third-party service integrations
ENABLE_GOOGLE_ANALYTICS=false
GOOGLE_ANALYTICS_ID=your_ga_id

ENABLE_MIXPANEL=false
MIXPANEL_TOKEN=your_mixpanel_token

# =============================================================================
# DEVELOPMENT TOOLS
# =============================================================================
# Development and debugging tools
ENABLE_PROFILING=false
ENABLE_MEMORY_PROFILING=false
ENABLE_CPU_PROFILING=false

# API documentation
ENABLE_SWAGGER_UI=true
ENABLE_REDOC=true
API_DOCS_TITLE=Equity Research Dashboard API
API_DOCS_VERSION=1.0.0
API_DOCS_DESCRIPTION=Backend API for Equity Research Dashboard

# =============================================================================
# TESTING CONFIGURATION
# =============================================================================
# Testing settings
ENABLE_TEST_MODE=false
TEST_DATA_PATH=tests/fixtures/
MOCK_EXTERNAL_APIS=false
ENABLE_COVERAGE_REPORTS=true

# =============================================================================
# DEPLOYMENT CONFIGURATION
# =============================================================================
# Deployment-specific settings
DEPLOYMENT_ENVIRONMENT=development
CONTAINER_NAME=equity-research-backend
CONTAINER_PORT=8000
HEALTH_CHECK_PATH=/api/v1/health

# Load balancer configuration
LOAD_BALANCER_ENABLED=false
LOAD_BALANCER_ALGORITHM=round_robin

# =============================================================================
# NOTES
# =============================================================================
# 1. Replace all placeholder values with your actual configuration
# 2. Ensure SECRET_KEY is at least 32 characters long in production
# 3. Use environment-specific values for different deployment stages
# 4. Keep API keys secure and never commit them to version control
# 5. Monitor API usage and costs for financial data providers
# 6. Regularly update dependencies and security patches
# 7. Test all configurations in a staging environment before production